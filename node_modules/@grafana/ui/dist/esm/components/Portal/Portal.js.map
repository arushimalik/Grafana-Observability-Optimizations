{"version":3,"file":"Portal.js","sources":["../../../../src/components/Portal/Portal.tsx"],"sourcesContent":["import { css, cx } from '@emotion/css';\nimport { PropsWithChildren, useLayoutEffect, useRef } from 'react';\nimport * as React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2, useTheme2 } from '../../themes';\n\ninterface Props {\n  className?: string;\n  root?: HTMLElement;\n  forwardedRef?: React.ForwardedRef<HTMLDivElement>;\n}\n\nexport function Portal(props: PropsWithChildren<Props>) {\n  const { children, className, root, forwardedRef } = props;\n  const theme = useTheme2();\n  const node = useRef<HTMLDivElement | null>(null);\n  const portalRoot = root ?? getPortalContainer();\n\n  if (!node.current) {\n    node.current = document.createElement('div');\n    if (className) {\n      node.current.className = className;\n    }\n    node.current.style.position = 'relative';\n    node.current.style.zIndex = `${theme.zIndex.portal}`;\n  }\n\n  useLayoutEffect(() => {\n    if (node.current) {\n      portalRoot.appendChild(node.current);\n    }\n\n    return () => {\n      if (node.current) {\n        portalRoot.removeChild(node.current);\n      }\n    };\n  }, [portalRoot]);\n\n  return ReactDOM.createPortal(<div ref={forwardedRef}>{children}</div>, node.current);\n}\n\n/** @internal */\nexport function getPortalContainer() {\n  return window.document.getElementById('grafana-portal-container') ?? document.body;\n}\n\n/** @internal */\nexport function PortalContainer() {\n  const styles = useStyles2(getStyles);\n  const isBodyScrolling = window.grafanaBootData?.settings.featureToggles.bodyScrolling;\n  return (\n    <div\n      id=\"grafana-portal-container\"\n      className={cx({\n        [styles.grafanaPortalContainer]: isBodyScrolling,\n      })}\n    />\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  grafanaPortalContainer: css({\n    position: 'fixed',\n    top: 0,\n    width: '100%',\n    zIndex: theme.zIndex.portal,\n  }),\n});\n\nexport const RefForwardingPortal = React.forwardRef<HTMLDivElement, Props>((props, ref) => {\n  return <Portal {...props} forwardedRef={ref} />;\n});\n\nRefForwardingPortal.displayName = 'RefForwardingPortal';\n"],"names":[],"mappings":"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"}